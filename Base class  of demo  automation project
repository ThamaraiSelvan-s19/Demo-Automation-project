package com.smartshop.base;

import java.io.File;
import java.io.IOException;
import java.time.Duration;
import java.util.HashMap;
import java.util.Map;

import org.apache.commons.io.FileUtils;
import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.support.ui.Select;

public class BaseTest {
    
	public static WebDriver driver;
	 public  void setup() {
		
		 if (driver == null) {
		        ChromeOptions options = new ChromeOptions();

		        // Add Chrome preferences
		        Map<String, Object> prefs = new HashMap<>();
		        prefs.put("profile.password_manager_enabled", false);
		        prefs.put("credentials_enable_service", false);
		        prefs.put("autofill.profile_enabled", false);   // disables address autofill
		        prefs.put("autofill.credit_card_enabled", false); // disables card autofill
		        options.setExperimentalOption("prefs", prefs);

		        driver = new ChromeDriver(options);
		        driver.manage().window().maximize();
		        driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(3));
		 }
	}
	public  void openurl() {
		driver.get("https://automationexercise.com/");
	}
	 //---------------navigation-------------
	
	public void NavigateBack() {
		 driver.navigate().back();
	}
	public static WebElement findElementByid(String locator) {
		WebElement element = driver.findElement(By.id(locator));
		return element;
	}	
	public static WebElement findElementByname(String locator) {
		WebElement element = driver.findElement(By.name(locator));
		return element;
	}
	public static WebElement findElementByclass(String locator) {
		WebElement element = driver.findElement(By.className(locator));
		return element;
	}	
	public static WebElement findElementByXpath(String locator) {
		WebElement element = driver.findElement(By.xpath(locator));
		return element;
	}	
	
	public static void click(WebElement element) {
		element.click();		
}
	public static void elementSendKeys(WebElement element,String ipt) {
		element.sendKeys(ipt);
}
	
	public static void alertaccept() {
		Alert a1 = driver.switchTo().alert();
		a1.accept();
		}
	public static void alertdecline() {
		Alert a1 = driver.switchTo().alert();
	     a1.dismiss();
		}
	public void alertsendkeys(WebElement element) {
		Alert a1 = driver.switchTo().alert();
	     a1.sendKeys("ok ok ");
		}
	public void selectind(WebElement element,int index) {
		Select s1 = new Select(element);
		s1.selectByIndex(index);
	}
	public void selectvalue(WebElement element,String value) {
		Select s1 = new Select(element);
		s1.selectByValue(value);
	}
	public static void addToCartByIndex(int index) {
	  findElementByXpath("(//a[contains(text(),'Add to cart')])[" + index + "]").click();
	}
	public static void clk_view_product(int index) {
		WebElement VP_CLK = findElementByXpath("(//a[contains(text(),'View Product')])[" + index + "]");
		click(VP_CLK);
	}
	public static void inside_add2cart() {
		findElementByXpath("//input[@name='product_id']/following::button[@class='btn btn-default cart']").click();
	}
	public static void continueshoping_btn() {
		findElementByXpath("//button[text()='Continue Shopping']").click();
	}
	public static void scrollelementup(WebElement element) {
		JavascriptExecutor js =(JavascriptExecutor)driver;
		js.executeScript("arguments[0].scrollIntoView(false)", element);
	}
	public static void scrollelementdown(WebElement element) {
		JavascriptExecutor js =(JavascriptExecutor)driver;
		js.executeScript("arguments[0].scrollIntoView(true)", element);
	}
public static void jsclick(WebElement element) {
	JavascriptExecutor js =(JavascriptExecutor)driver;
	js.executeScript("arguments[0].click()", element);
}
     public static void spinbtn(int times) {
    	 for (int i = 0; i < times; i++) {
    		 findElementByname("quantity").sendKeys(Keys.ARROW_UP);
		}
     }
     public static void uploadfile(WebElement fileinput,String path) {
    	 fileinput.sendKeys(path);
     }
	public Object Screenshot(WebElement e1) throws IOException {
		TakesScreenshot ts =(TakesScreenshot)e1;
		File f1=ts.getScreenshotAs(OutputType.FILE);
		File path =new File("C:\\AUTOMATION TESTING\\f1\\1\\game");
	FileUtils.copyFile(f1, path);
	return path;
	}

	public  void teardown() {
		 if (driver != null) {
	            driver.quit();
	            driver = null;
	}
	}	}
